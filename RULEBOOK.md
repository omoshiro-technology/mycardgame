# 公式ルールブック（自動生成）

このドキュメントは型情報とプログラム定数から生成された、プレイ用のルールです。
ゲームデザイン上の調整値はコードで一貫管理され、カード相互作用の安全性は自動検証されています。

## ゲームの目的

- 対戦相手のライフを0以下にして勝利する

## 準備

- 各プレイヤーは自分のデッキ（最低40枚、同名は最大3枚）を用意する
- 各プレイヤーの初期ライフは20
- 各プレイヤーは初期手札として5枚引く
- ムリガン（ロンドン）: 手札を引き直した後、1枚をライブラリーの下に置く

## ターンの流れ

- ターンの開始時にカードを1枚引く
- フェイズ順序: アップキープ → メイン → 戦闘 → エンド
- アクションはスタックで解決（後入れ先出し）。各フェイズ中、プレイヤーは交互に行動できる
- 同時に誘発した能力の処理順はコントローラーが選ぶ

## カードの種類

- ユニット / スペル / アーティファクト / エンチャント
- ユニット: 攻撃力/体力（ATK/HP）を持ち、戦場に残る
- スペル: 効果を解決して墓地へ置く（特別な記載がない限り）
- アーティファクト/エンチャント: 戦場に残り、継続的な効果や能力を与える

## ゾーン

- 主なゾーン: ライブラリー / 手札 / 戦場 / 墓地 / 追放領域 / スタック
- 戦場にあるカードは「場に出ている」状態
- トークンが場を離れたら墓地へ

## トークン

- トークンはカードの効果で生成される一時的なユニット
- 通常のユニットと同様に攻撃・ダメージ・破壊の影響を受ける
- 手札やライブラリーには置かれず、戦場から離れると即座に消滅扱い（墓地/追放に置かれたあと存在しなくなる）
- このターンに生成されたトークンにも召喚酔いは適用される

## カードのプレイ

- 自分のメインフェイズにコストを支払ってカードを唱える
- 対象がある効果は宣言時に対象を選ぶ
- 解決時にすべての対象が不適正になった場合、その効果は不発

## コストとリソース

- リソースモード: アクションポイント方式
- エネルギーは各ターン開始時に1増える（未使用分はターン終了時に失われる）
- 保持できるエネルギーの上限は特にない
- カードのコストは汎用コスト（generic）で支払う
- 色（W, U, B, R, G）はデッキ構築上の所属を示すのみで、支払いには不要

## 戦闘

- ブロックは存在しない（攻撃は妨げられない）
- このターンに出たユニットは攻撃できない
- 攻撃ユニットは対戦相手か相手のユニットを攻撃対象として選ぶ
- 攻撃力分のダメージを与える。ダメージはそのターン中、ユニットに残る
- ユニットの体力が0以下になったら破壊される

## 能力と効果

- 唱えたときの効果: カードを唱えるとただちに解決する効果
- トリガー能力: 「～したとき」などの条件で誘発する能力
- 常在能力: 戦場にある限り継続する効果や修整
- 置換効果: 「～する代わりに」特定の出来事を置き換える効果（同じ出来事を再発生させる置換は禁止）

## IR（型仕様）

### 値（Value）

- Clamp: メトリクスを[min,max]で丸める
- Const: 定数値 n を参照する

### メトリクス（Metric）

- BoardCount: 指定ゾーン/タグの枚数を数える
- CardStat: （対象/自身）のATK/HPを参照する
- Const: 定数値
- Life: プレイヤーのライフを参照する

### 述語（Predicate）

- And: すべての条件が真
- Cmp: メトリクス間の比較（>=, >, <=, <, ==, !=）
- ControllerIs: コントローラーがSELF/OPPである
- EventOccurred: 直近(TURN/GAME)でイベントがN回以上起きた
- HasAttribute: 指定属性（Element/Class/Species）を持つ
- HasCounter: 指定カウンターをN個以上持つ
- HasName: 名称が一致/前方一致/部分一致する
- HasTag: 指定タグを持つ
- IsToken: トークンである
- Not: 条件の否定
- Or: いずれかの条件が真
- True: 常に真
- WasSummonedThisTurn: このターンに登場した

### セレクター（Selector）

- owner: SELF/OPP を指定
- zone: 対象ゾーン（LIB/HAND/BF/GY/EXILE/STACK）
- max: 選べる最大数の上限（追加の制約でさらに絞られることあり）
- filter: 述語（Predicate）で対象を絞り込み

### 効果（Effect）

- AddCounter: カウンターを置く
- Buff: 一時/永続のATK/HP修整
- Case: 複数の条件分岐
- ChangeController: コントロールを変更（期間）
- Conditional: if/then/else 条件分岐
- CopyStats: 能力値をコピー（クランプ付き）
- CreateToken: トークンを生成する（ATK/HP/タグ）
- DealDamage: 対象にダメージを与える
- Draw: カードを引く
- ForEach: 複数対象に繰り返し適用
- Heal: 対象を回復する
- LookAtTop: ライブラリーの上を見て選ぶ
- Mill: ライブラリーから墓地へ送る
- Move: 対象を指定ゾーンに移動
- NoOp: 何もしない
- PreventDamage: 対象へのダメージを軽減/防止（期間）
- RemoveCounter: カウンターを取り除く
- Repeat: 効果を回数分繰り返し
- Sequence: 複数効果を順番に実行
- Transform: 別の姿に変化

### トリガー（Trigger）

- OnAttack: 攻撃したとき
- OnCast: 呪文を唱えたとき
- OnDamageDealt: ダメージを与えたとき
- OnDeath: 破壊/死亡したとき
- OnDraw: カードを引いたとき
- OnEnter: 戦場に出たとき
- OnNameMatched: 指定名に一致したとき
- OnTokenCreated: トークンが生成されたとき
- OnUpkeepStart: アップキープ開始時

### 置換効果（Replacement）

- WouldBeDamaged: ダメージを受ける代わりに
- WouldDie: 破壊される代わりに
- WouldDraw: ドローする代わりに
- limit: 同一カードにつき期間（TURN/GAME）で回数制限が必要
- duration: 効果の持続時間（EOT/PERM）

### 常在効果（Continuous）

- CostModifier: コスト修整（下限指定可）
- StaticBuff: 常在のATK/HP修整

### 時間（Duration）

- EOT: ターン終了時まで
- PERM: 永続

## ダメージ・回復・カウンター

- ダメージはユニットの体力を減らす。ターン終了時にダメージはリセットされる
- 回復はユニットの現在体力を増やす（最大値を超えない場合がある）
- カウンターはカード上に置かれる目印で、能力の条件や修整に使用される

## 勝敗

- あなたのライフが0以下になったら敗北
- 空のライブラリーから引けない場合は敗北
- 手札上限は10枚（調整を受ける場合あり）

## 付録（品質保証）

- 本ゲームは、カードの相互作用によって無限ループが発生しないよう自動検証を実施しています

検証結果: OK（致命的な循環なし）

ルール仕様のヌケモレ検査: OK

---

この文書は `scripts/generate-rulebook.ts` により生成されました。
